diff -urN u-boot-2016.11/arch/arm/config.mk u-boot-2016.11_100ask/arch/arm/config.mk
--- u-boot-2016.11/arch/arm/config.mk	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/arch/arm/config.mk	2020-07-31 18:02:21.666110276 +0800
@@ -108,7 +108,7 @@
 
 ifneq ($(CONFIG_SPL_BUILD),y)
 # Check that only R_ARM_RELATIVE relocations are generated.
-ALL-y += checkarmreloc
+#ALL-y += checkarmreloc
 # The movt / movw can hardcode 16 bit parts of the addresses in the
 # instruction. Relocation is not supported for that case, so disable
 # such usage by requiring word relocations.
diff -urN u-boot-2016.11/arch/arm/cpu/arm920t/start.S u-boot-2016.11_100ask/arch/arm/cpu/arm920t/start.S
--- u-boot-2016.11/arch/arm/cpu/arm920t/start.S	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/arch/arm/cpu/arm920t/start.S	2020-07-31 18:02:21.642110163 +0800
@@ -83,7 +83,7 @@
 	/* FCLK:HCLK:PCLK = 1:2:4 */
 	/* default FCLK is 120 MHz ! */
 	ldr	r0, =CLKDIVN
-	mov	r1, #3
+	mov	r1, #5  /* FCLK:HCLK:PCLK=1:4:8 DaQui modified */ 
 	str	r1, [r0]
 #endif	/* CONFIG_S3C24X0 */
 
diff -urN u-boot-2016.11/arch/arm/cpu/u-boot.lds u-boot-2016.11_100ask/arch/arm/cpu/u-boot.lds
--- u-boot-2016.11/arch/arm/cpu/u-boot.lds	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/arch/arm/cpu/u-boot.lds	2020-07-31 18:02:21.646110181 +0800
@@ -18,24 +18,6 @@
 #ifndef CONFIG_CMDLINE
 	/DISCARD/ : { *(.u_boot_list_2_cmd_*) }
 #endif
-#if defined(CONFIG_ARMV7_SECURE_BASE) && defined(CONFIG_ARMV7_NONSEC)
-	/*
-	 * If CONFIG_ARMV7_SECURE_BASE is true, secure code will not
-	 * bundle with u-boot, and code offsets are fixed. Secure zone
-	 * only needs to be copied from the loading address to
-	 * CONFIG_ARMV7_SECURE_BASE, which is the linking and running
-	 * address for secure code.
-	 *
-	 * If CONFIG_ARMV7_SECURE_BASE is undefined, the secure zone will
-	 * be included in u-boot address space, and some absolute address
-	 * were used in secure code. The absolute addresses of the secure
-	 * code also needs to be relocated along with the accompanying u-boot
-	 * code.
-	 *
-	 * So DISCARD is only for CONFIG_ARMV7_SECURE_BASE.
-	 */
-	/DISCARD/ : { *(.rel._secure*) }
-#endif
 	. = 0x00000000;
 
 	. = ALIGN(4);
@@ -47,77 +29,6 @@
 		*(.text*)
 	}
 
-#ifdef CONFIG_ARMV7_NONSEC
-
-	/* Align the secure section only if we're going to use it in situ */
-	.__secure_start :
-#ifndef CONFIG_ARMV7_SECURE_BASE
-		ALIGN(CONSTANT(COMMONPAGESIZE))
-#endif
-	{
-		KEEP(*(.__secure_start))
-	}
-
-#ifndef CONFIG_ARMV7_SECURE_BASE
-#define CONFIG_ARMV7_SECURE_BASE
-#define __ARMV7_PSCI_STACK_IN_RAM
-#endif
-
-	.secure_text CONFIG_ARMV7_SECURE_BASE :
-		AT(ADDR(.__secure_start) + SIZEOF(.__secure_start))
-	{
-		*(._secure.text)
-	}
-
-	.secure_data : AT(LOADADDR(.secure_text) + SIZEOF(.secure_text))
-	{
-		*(._secure.data)
-	}
-
-#ifdef CONFIG_ARMV7_PSCI
-	.secure_stack ALIGN(ADDR(.secure_data) + SIZEOF(.secure_data),
-			    CONSTANT(COMMONPAGESIZE)) (NOLOAD) :
-#ifdef __ARMV7_PSCI_STACK_IN_RAM
-		AT(ADDR(.secure_stack))
-#else
-		AT(LOADADDR(.secure_data) + SIZEOF(.secure_data))
-#endif
-	{
-		KEEP(*(.__secure_stack_start))
-
-		/* Skip addreses for stack */
-		. = . + CONFIG_ARMV7_PSCI_NR_CPUS * ARM_PSCI_STACK_SIZE;
-
-		/* Align end of stack section to page boundary */
-		. = ALIGN(CONSTANT(COMMONPAGESIZE));
-
-		KEEP(*(.__secure_stack_end))
-
-#ifdef CONFIG_ARMV7_SECURE_MAX_SIZE
-		/*
-		 * We are not checking (__secure_end - __secure_start) here,
-		 * as these are the load addresses, and do not include the
-		 * stack section. Instead, use the end of the stack section
-		 * and the start of the text section.
-		 */
-		ASSERT((. - ADDR(.secure_text)) <= CONFIG_ARMV7_SECURE_MAX_SIZE,
-		       "Error: secure section exceeds secure memory size");
-#endif
-	}
-
-#ifndef __ARMV7_PSCI_STACK_IN_RAM
-	/* Reset VMA but don't allocate space if we have secure SRAM */
-	. = LOADADDR(.secure_stack);
-#endif
-
-#endif
-
-	.__secure_end : AT(ADDR(.__secure_end)) {
-		*(.__secure_end)
-		LONG(0x1d1071c);	/* Must output something to reset LMA */
-	}
-#endif
-
 	. = ALIGN(4);
 	.rodata : { *(SORT_BY_ALIGNMENT(SORT_BY_NAME(.rodata*))) }
 
diff -urN u-boot-2016.11/arch/arm/Kconfig u-boot-2016.11_100ask/arch/arm/Kconfig
--- u-boot-2016.11/arch/arm/Kconfig	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/arch/arm/Kconfig	2020-07-31 18:02:21.666110276 +0800
@@ -145,6 +145,10 @@
 	bool "Support smdk2410"
 	select CPU_ARM920T
 
+config TARGET_JZ2440
+	bool "Support JZ2440"
+	select CPU_ARM920T
+
 config TARGET_ASPENITE
 	bool "Support aspenite"
 	select CPU_ARM926EJS
@@ -992,6 +996,7 @@
 source "board/phytec/pcm052/Kconfig"
 source "board/ppcag/bg0900/Kconfig"
 source "board/samsung/smdk2410/Kconfig"
+source "board/samsung/jz2440/Kconfig"
 source "board/sandisk/sansa_fuze_plus/Kconfig"
 source "board/schulercontrol/sc_sps_1/Kconfig"
 source "board/siemens/draco/Kconfig"
diff -urN u-boot-2016.11/board/samsung/jz2440/init.c u-boot-2016.11_100ask/board/samsung/jz2440/init.c
--- u-boot-2016.11/board/samsung/jz2440/init.c	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/init.c	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,214 @@
+#ifdef CONFIG_SPL_BUILD
+
+#define CONFIG_SPL_NAND_IMAGE_BASE (0x20000)
+#define CONFIG_SPL_RELOC_DEST_ADDR (0x33F00000)
+#define CONFIG_SPL_RELOC_LEN 	   (0x40000)
+
+
+/* NAND FLASH¿ØÖÆÆ÷ */
+#define NFCONF (*((volatile unsigned long *)0x4E000000))
+#define NFCONT (*((volatile unsigned long *)0x4E000004))
+#define NFCMMD (*((volatile unsigned char *)0x4E000008))
+#define NFADDR (*((volatile unsigned char *)0x4E00000C))
+#define NFDATA (*((volatile unsigned char *)0x4E000010))
+#define NFSTAT (*((volatile unsigned char *)0x4E000020))
+
+/* GPIO */
+#define GPHCON              (*(volatile unsigned long *)0x56000070)
+#define GPHUP               (*(volatile unsigned long *)0x56000078)
+
+/* UART registers*/
+#define ULCON0              (*(volatile unsigned long *)0x50000000)
+#define UCON0               (*(volatile unsigned long *)0x50000004)
+#define UFCON0              (*(volatile unsigned long *)0x50000008)
+#define UMCON0              (*(volatile unsigned long *)0x5000000c)
+#define UTRSTAT0            (*(volatile unsigned long *)0x50000010)
+#define UTXH0               (*(volatile unsigned char *)0x50000020)
+#define URXH0               (*(volatile unsigned char *)0x50000024)
+#define UBRDIV0             (*(volatile unsigned long *)0x50000028)
+
+#define TXD0READY   (1<<2)
+
+
+void nand_read_ll(unsigned int addr, unsigned char *buf, unsigned int len);
+
+
+static int isBootFromNorFlash(void)
+{
+	volatile int *p = (volatile int *)0;
+	int val;
+
+	val = *p;
+	*p = 0x12345678;
+	if (*p == 0x12345678)
+	{
+		/* Ð´³É¹¦, ÊÇnandÆô¶¯ */
+		*p = val;
+		return 0;
+	}
+	else
+	{
+		/* NOR²»ÄÜÏñÄÚ´æÒ»ÑùÐ´ */
+		return 1;
+	}
+}
+
+void copy_code_to_sdram(unsigned char *src, unsigned char *dest, unsigned int len)
+{	
+	int i = 0;
+	
+	/* Èç¹ûÊÇNORÆô¶¯ */
+	if (isBootFromNorFlash())
+	{
+		while (i < len)
+		{
+			dest[i] = src[i];
+			i++;
+		}
+	}
+	else
+	{
+		//nand_init();
+		nand_read_ll((unsigned int)src, dest, len);
+	}
+}
+
+void nand_init_ll(void)
+{
+#define TACLS   0
+#define TWRPH0  1
+#define TWRPH1  0
+	/* ÉèÖÃÊ±Ðò */
+	NFCONF = (TACLS<<12)|(TWRPH0<<8)|(TWRPH1<<4);
+	/* Ê¹ÄÜNAND Flash¿ØÖÆÆ÷, ³õÊ¼»¯ECC, ½ûÖ¹Æ¬Ñ¡ */
+	NFCONT = (1<<4)|(1<<1)|(1<<0);	
+}
+
+void nand_select(void)
+{
+	NFCONT &= ~(1<<1);	
+}
+
+void nand_deselect(void)
+{
+	NFCONT |= (1<<1);	
+}
+
+void nand_cmd(unsigned char cmd)
+{
+	volatile int i;
+	NFCMMD = cmd;
+	for (i = 0; i < 10; i++);
+}
+
+void nand_addr(unsigned int addr)
+{
+	unsigned int col  = addr % 2048;
+	unsigned int page = addr / 2048;
+	volatile int i;
+
+	NFADDR = col & 0xff;
+	for (i = 0; i < 10; i++);
+	NFADDR = (col >> 8) & 0xff;
+	for (i = 0; i < 10; i++);
+	
+	NFADDR  = page & 0xff;
+	for (i = 0; i < 10; i++);
+	NFADDR  = (page >> 8) & 0xff;
+	for (i = 0; i < 10; i++);
+	NFADDR  = (page >> 16) & 0xff;
+	for (i = 0; i < 10; i++);	
+}
+
+void nand_wait_ready(void)
+{
+	while (!(NFSTAT & 1));
+}
+
+unsigned char nand_data(void)
+{
+	return NFDATA;
+}
+
+void nand_read_ll(unsigned int addr, unsigned char *buf, unsigned int len)
+{
+	int col = addr % 2048;
+	int i = 0;
+		
+	/* 1. Ñ¡ÖÐ */
+	nand_select();
+
+	while (i < len)
+	{
+		/* 2. ·¢³ö¶ÁÃüÁî00h */
+		nand_cmd(0x00);
+
+		/* 3. ·¢³öµØÖ·(·Ö5²½·¢³ö) */
+		nand_addr(addr);
+
+		/* 4. ·¢³ö¶ÁÃüÁî30h */
+		nand_cmd(0x30);
+
+		/* 5. ÅÐ¶Ï×´Ì¬ */
+		nand_wait_ready();
+
+		/* 6. ¶ÁÊý¾Ý */
+		for (; (col < 2048) && (i < len); col++)
+		{
+			buf[i] = nand_data();
+			i++;
+			addr++;
+		}
+		
+		col = 0;
+	}
+
+	/* 7. È¡ÏûÑ¡ÖÐ */		
+	nand_deselect();
+}
+
+void fix_reldyn(void)
+{
+	extern char __rel_dyn_start[0];
+	extern char __rel_dyn_end[0];
+	
+	char *rd_startp = __rel_dyn_start;
+	char *rd_endp = __rel_dyn_end;
+#if 0
+		/*
+		 * fix .rel.dyn relocations
+		 */
+		ldr r2, =__rel_dyn_start	/* r2 <- SRC &__rel_dyn_start */
+		ldr r3, =__rel_dyn_end	/* r3 <- SRC &__rel_dyn_end */
+	fixloop:
+		ldmia	r2!, {r0-r1}		/* (r0,r1) <- (SRC location,fixup) */
+		and r1, r1, #0xff
+		cmp r1, #23 		/* relative fixup? */
+		bne fixnext
+	
+		/* relative fix: increase location by offset */
+		add r0, r0, r4
+		ldr r1, [r0]
+		add r1, r1, r4
+		str r1, [r0]
+	fixnext:
+		cmp r2, r3
+		blo fixloop
+#endif
+}
+
+void board_init_f(unsigned long boot_flags)
+{
+	nand_init_ll();
+	copy_code_to_sdram((char *)CONFIG_SPL_NAND_IMAGE_BASE, (char *)CONFIG_SPL_RELOC_DEST_ADDR, CONFIG_SPL_RELOC_LEN);
+	fix_reldyn();
+	
+	__attribute__((noreturn)) void (*uboot)(void);
+	 /* Jump to U-Boot image */
+	uboot = (void *)CONFIG_SPL_RELOC_DEST_ADDR;
+	(*uboot)();
+	/* Never returns Here */
+}
+
+#endif /* CONFIG_SPL_BUILD */
+
diff -urN u-boot-2016.11/board/samsung/jz2440/jz2440.c u-boot-2016.11_100ask/board/samsung/jz2440/jz2440.c
--- u-boot-2016.11/board/samsung/jz2440/jz2440.c	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/jz2440.c	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,158 @@
+/*
+ * (C) Copyright 2002
+ * Sysgo Real-Time Solutions, GmbH <www.elinos.com>
+ * Marius Groeger <mgroeger@sysgo.de>
+ *
+ * (C) Copyright 2002, 2010
+ * David Mueller, ELSOFT AG, <d.mueller@elsoft.ch>
+ *
+ * SPDX-License-Identifier:	GPL-2.0+
+ */
+
+#include <common.h>
+#include <netdev.h>
+#include <asm/io.h>
+#include <asm/arch/s3c24x0_cpu.h>
+
+DECLARE_GLOBAL_DATA_PTR;
+
+#define FCLK_SPEED 1
+
+#if (FCLK_SPEED == 0)		/* Fout = 203MHz, Fin = 12MHz for Audio */
+#define M_MDIV	0xC3
+#define M_PDIV	0x4
+#define M_SDIV	0x1
+#elif (FCLK_SPEED == 1)		/* Fout = 202.8MHz */
+#define M_MDIV	0xA1
+#define M_PDIV	0x3
+#define M_SDIV	0x1
+#endif
+
+#define USB_CLOCK 1
+
+#if (USB_CLOCK == 0)
+#define U_M_MDIV	0xA1
+#define U_M_PDIV	0x3
+#define U_M_SDIV	0x1
+#elif (USB_CLOCK == 1)
+#define U_M_MDIV	0x48
+#define U_M_PDIV	0x3
+#define U_M_SDIV	0x2
+#endif
+
+static inline void pll_delay(unsigned long loops)
+{
+	__asm__ volatile ("1:\n"
+	  "subs %0, %1, #1\n"
+	  "bne 1b" : "=r" (loops) : "0" (loops));
+}
+
+/*
+ * Miscellaneous platform dependent initialisations
+ */
+
+int board_early_init_f(void)
+{
+	struct s3c24x0_gpio * const gpio = s3c24x0_get_base_gpio();
+
+#ifndef CONFIG_JZ2440 
+	struct s3c24x0_clock_power * const clk_power =
+					s3c24x0_get_base_clock_power();
+
+	/* to reduce PLL lock time, adjust the LOCKTIME register */
+	writel(0xFFFFFF, &clk_power->locktime);
+
+	/* configure MPLL */
+	writel((M_MDIV << 12) + (M_PDIV << 4) + M_SDIV,
+	       &clk_power->mpllcon);
+
+	/* some delay between MPLL and UPLL */
+	pll_delay(4000);
+
+	/* configure UPLL */
+	writel((U_M_MDIV << 12) + (U_M_PDIV << 4) + U_M_SDIV,
+	       &clk_power->upllcon);
+
+	/* some delay between MPLL and UPLL */
+	pll_delay(8000);
+#endif
+
+	/* set up the I/O ports */
+	writel(0x007FFFFF, &gpio->gpacon);
+	writel(0x00044555, &gpio->gpbcon);
+	writel(0x000007FF, &gpio->gpbup);
+	writel(0xAAAAAAAA, &gpio->gpccon);
+	writel(0x0000FFFF, &gpio->gpcup);
+	writel(0xAAAAAAAA, &gpio->gpdcon);
+	writel(0x0000FFFF, &gpio->gpdup);
+	writel(0xAAAAAAAA, &gpio->gpecon);
+	writel(0x0000FFFF, &gpio->gpeup);
+	writel(0x000055AA, &gpio->gpfcon);
+	writel(0x000000FF, &gpio->gpfup);
+	writel(0xFF95FFBA, &gpio->gpgcon);
+	writel(0x0000FFFF, &gpio->gpgup);
+	writel(0x002AFAAA, &gpio->gphcon);
+	writel(0x000007FF, &gpio->gphup);
+
+	return 0;
+}
+
+int board_init(void)
+{
+	/* arch number of SMDK2410-Board */
+	gd->bd->bi_arch_number = MACH_TYPE_SMDK2410;
+
+	/* adress of boot parameters */
+	gd->bd->bi_boot_params = 0x30000100;
+
+	icache_enable();
+	dcache_enable();
+
+	return 0;
+}
+
+int dram_init(void)
+{
+	/* dram_init must store complete ramsize in gd->ram_size */
+	gd->ram_size = PHYS_SDRAM_1_SIZE;
+	return 0;
+}
+
+#ifdef CONFIG_CMD_NET
+int board_eth_init(bd_t *bis)
+{
+	int rc = 0;
+	unsigned char mac_addr[6];
+
+	/* DaQui modified */
+	
+	mac_addr[0] = 0x60;
+	mac_addr[1] = 0xF2;
+	mac_addr[2] = 0xEF;
+	mac_addr[3] = 0x03;
+	mac_addr[4] = 0x03;
+	mac_addr[5] = 0x1F;
+
+	if (!getenv("ethaddr")) {
+			puts("<ethaddr> not set. Validating first E-fuse MAC\n");
+			if (is_valid_ethaddr(mac_addr))
+					eth_setenv_enetaddr("ethaddr", mac_addr);
+	}
+	
+	rc = dm9000_initialize(bis);
+	
+	return rc;
+}
+#endif
+
+/*
+ * Hardcoded flash setup:
+ * Flash 0 is a non-CFI AMD AM29LV800BB flash.
+ */
+ulong board_flash_get_legacy(ulong base, int banknum, flash_info_t *info)
+{
+	info->portwidth = FLASH_CFI_16BIT;
+	info->chipwidth = FLASH_CFI_BY16;
+	info->interface = FLASH_CFI_X16;
+	return 1;
+}
diff -urN u-boot-2016.11/board/samsung/jz2440/Kconfig u-boot-2016.11_100ask/board/samsung/jz2440/Kconfig
--- u-boot-2016.11/board/samsung/jz2440/Kconfig	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/Kconfig	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,15 @@
+if TARGET_JZ2440
+
+config SYS_BOARD
+	default "jz2440"
+
+config SYS_VENDOR
+	default "samsung"
+
+config SYS_SOC
+	default "s3c24x0"
+
+config SYS_CONFIG_NAME
+	default "jz2440"
+
+endif
diff -urN u-boot-2016.11/board/samsung/jz2440/lowlevel_init.S u-boot-2016.11_100ask/board/samsung/jz2440/lowlevel_init.S
--- u-boot-2016.11/board/samsung/jz2440/lowlevel_init.S	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/lowlevel_init.S	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,166 @@
+/*
+ * Memory Setup stuff - taken from blob memsetup.S
+ *
+ * Copyright (C) 1999 2000 2001 Erik Mouw (J.A.K.Mouw@its.tudelft.nl) and
+ *                     Jan-Derk Bakker (J.D.Bakker@its.tudelft.nl)
+ *
+ * Modified for the Samsung SMDK2410 by
+ * (C) Copyright 2002
+ * David Mueller, ELSOFT AG, <d.mueller@elsoft.ch>
+ *
+ * SPDX-License-Identifier:	GPL-2.0+
+ */
+
+
+#include <config.h>
+
+/* some parameters for the board */
+
+/*
+ *
+ * Taken from linux/arch/arm/boot/compressed/head-s3c2410.S
+ *
+ * Copyright (C) 2002 Samsung Electronics SW.LEE  <hitchcar@sec.samsung.com>
+ *
+ */
+
+#define BWSCON	0x48000000
+
+/* BWSCON */
+#define DW8			(0x0)
+#define DW16			(0x1)
+#define DW32			(0x2)
+#define WAIT			(0x1<<2)
+#define UBLB			(0x1<<3)
+
+#define B1_BWSCON		(DW32)
+#define B2_BWSCON		(DW16)
+#define B3_BWSCON		(DW16 + WAIT + UBLB)
+#define B4_BWSCON		(DW16)
+#define B5_BWSCON		(DW16)
+#define B6_BWSCON		(DW32)
+#define B7_BWSCON		(DW32)
+
+/* BANK0CON */
+#define B0_Tacs			0x0	/*  0clk */
+#define B0_Tcos			0x0	/*  0clk */
+#define B0_Tacc			0x7	/* 14clk */
+#define B0_Tcoh			0x0	/*  0clk */
+#define B0_Tah			0x0	/*  0clk */
+#define B0_Tacp			0x0
+#define B0_PMC			0x0	/* normal */
+
+/* BANK1CON */
+#define B1_Tacs			0x0	/*  0clk */
+#define B1_Tcos			0x0	/*  0clk */
+#define B1_Tacc			0x7	/* 14clk */
+#define B1_Tcoh			0x0	/*  0clk */
+#define B1_Tah			0x0	/*  0clk */
+#define B1_Tacp			0x0
+#define B1_PMC			0x0
+
+#define B2_Tacs			0x0
+#define B2_Tcos			0x0
+#define B2_Tacc			0x7
+#define B2_Tcoh			0x0
+#define B2_Tah			0x0
+#define B2_Tacp			0x0
+#define B2_PMC			0x0
+
+#define B3_Tacs			0x0	/*  0clk */
+#define B3_Tcos			0x3	/*  4clk */
+#define B3_Tacc			0x7	/* 14clk */
+#define B3_Tcoh			0x1	/*  1clk */
+#define B3_Tah			0x0	/*  0clk */
+#define B3_Tacp			0x3     /*  6clk */
+#define B3_PMC			0x0	/* normal */
+
+#define B4_Tacs			0x0	/*  0clk */
+#define B4_Tcos			0x0	/*  0clk */
+#define B4_Tacc			0x7	/* 14clk */
+#define B4_Tcoh			0x0	/*  0clk */
+#define B4_Tah			0x0	/*  0clk */
+#define B4_Tacp			0x0
+#define B4_PMC			0x0	/* normal */
+
+#define B5_Tacs			0x0	/*  0clk */
+#define B5_Tcos			0x0	/*  0clk */
+#define B5_Tacc			0x7	/* 14clk */
+#define B5_Tcoh			0x0	/*  0clk */
+#define B5_Tah			0x0	/*  0clk */
+#define B5_Tacp			0x0
+#define B5_PMC			0x0	/* normal */
+
+#define B6_MT			0x3	/* SDRAM */
+#define B6_Trcd			0x1
+#define B6_SCAN			0x1	/* 9bit */
+
+#define B7_MT			0x3	/* SDRAM */
+#define B7_Trcd			0x1	/* 3clk */
+#define B7_SCAN			0x1	/* 9bit */
+
+/* REFRESH parameter */
+#define REFEN			0x1	/* Refresh enable */
+#define TREFMD			0x0	/* CBR(CAS before RAS)/Auto refresh */
+#define Trp			0x0	/* 2clk */
+#define Trc			0x3	/* 7clk */
+#define Tchr			0x2	/* 3clk */
+#define REFCNT			1113	/* period=15.6us, HCLK=60Mhz, (2048+1-15.6*60) */
+/**************************************/
+
+.globl lowlevel_init
+lowlevel_init:
+#ifdef CONFIG_SPL_BUILD /* DaQui modified */
+	#define S3C2440_MPLL_400MHZ     ((0x5c<<12)|(0x01<<4)|(0x01))
+	
+	/* å¦‚æžœHDIVNéž0ï¼ŒCPUçš„æ€»çº¿æ¨¡å¼åº”è¯¥ä»Žâ€œfast bus modeâ€å˜ä¸ºâ€œasynchronous bus modeâ€ */
+	mrc	p15, 0, r1, c1, c0, 0		/* è¯»å‡ºæŽ§åˆ¶å¯„å­˜å™¨ */ 
+	orr	r1, r1, #0xc0000000			/* è®¾ç½®ä¸ºâ€œasynchronous bus modeâ€ */
+	mcr	p15, 0, r1, c1, c0, 0		/* å†™å…¥æŽ§åˆ¶å¯„å­˜å™¨ */
+
+	/* MPLLCON = S3C2440_MPLL_200MHZ */
+	ldr r0, =0x4c000004
+	ldr r1, =S3C2440_MPLL_400MHZ
+	str r1, [r0]
+
+	/* å¯åŠ¨ICACHE */
+	mrc p15, 0, r0, c1, c0, 0	@ read control reg
+	orr r0, r0, #(1<<12)
+	mcr	p15, 0, r0, c1, c0, 0   @ write it back
+	
+	/* memory control configuration */
+	/* make r0 relative the current location so that it */
+	/* reads SMRDATA out of FLASH rather than memory ! */
+	ldr     r0, =SMRDATA
+	ldr		r1, =CONFIG_SPL_TEXT_BASE/* DaQui modified */
+	sub		r0, r0, r1
+	ldr		r1, =BWSCON	/* Bus Width Status Controller */
+	add     r2, r0, #13*4
+0:
+	ldr     r3, [r0], #4
+	str     r3, [r1], #4
+	cmp     r2, r0
+	bne     0b
+
+	/* everything is fine now */
+	mov	pc, lr
+
+	.ltorg
+/* the literal pools origin */
+SMRDATA: /* DaQui modified */
+		.long 0x22011110		 //BWSCON
+		.long 0x00000700		 //BANKCON0
+		.long 0x00000700		 //BANKCON1
+		.long 0x00000700		 //BANKCON2
+		.long 0x00000700		 //BANKCON3
+		.long 0x00000740		 //BANKCON4
+		.long 0x00000700		 //BANKCON5
+		.long 0x00018005		 //BANKCON6
+		.long 0x00018005		 //BANKCON7
+		.long 0x008C04F4		 // REFRESH
+		.long 0x000000B1		 //BANKSIZE
+		.long 0x00000030		 //MRSRB6
+		.long 0x00000030		 //MRSRB7
+#else  /* !CONFIG_SPL_BUILD */
+	mov	pc, lr /* skip low level init */
+#endif /* end CONFIG_SPL_BUILD */
diff -urN u-boot-2016.11/board/samsung/jz2440/MAINTAINERS u-boot-2016.11_100ask/board/samsung/jz2440/MAINTAINERS
--- u-boot-2016.11/board/samsung/jz2440/MAINTAINERS	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/MAINTAINERS	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,6 @@
+SMDK2410 BOARD
+M:	David MÃ¼ller <d.mueller@elsoft.ch>
+S:	Maintained
+F:	board/samsung/smdk2410/
+F:	include/configs/smdk2410.h
+F:	configs/smdk2410_defconfig
diff -urN u-boot-2016.11/board/samsung/jz2440/Makefile u-boot-2016.11_100ask/board/samsung/jz2440/Makefile
--- u-boot-2016.11/board/samsung/jz2440/Makefile	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/board/samsung/jz2440/Makefile	2020-07-31 18:02:21.722110538 +0800
@@ -0,0 +1,10 @@
+#
+# (C) Copyright 2000-2006
+# Wolfgang Denk, DENX Software Engineering, wd@denx.de.
+#
+# SPDX-License-Identifier:	GPL-2.0+
+#
+
+obj-y	:= jz2440.o
+obj-y	+= lowlevel_init.o
+obj-y	+= init.o
diff -urN u-boot-2016.11/cmd/nand.c u-boot-2016.11_100ask/cmd/nand.c
--- u-boot-2016.11/cmd/nand.c	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/cmd/nand.c	2020-07-31 18:02:21.734110593 +0800
@@ -539,7 +539,7 @@
 
 		return ret == 0 ? 1 : 0;
 	}
-
+	
 	if (strncmp(cmd, "read", 4) == 0 || strncmp(cmd, "write", 5) == 0) {
 		size_t rwsize;
 		ulong pagecount = 1;
@@ -623,6 +623,17 @@
 						maxsize, (u_char *)addr,
 						WITH_DROP_FFS | WITH_WR_VERIFY);
 #endif
+#ifdef CONFIG_CMD_NAND_YAFFS /*DaQui modified*/
+		} else if (!strcmp(s, ".yaffs")) {
+			if (read) {
+				printf("Unknown nand command suffix '%s'.\n", s);
+				return 1;
+			}
+			
+			ret = nand_write_skip_bad(mtd, off, &rwsize, NULL,
+									maxsize, (u_char *)addr, 
+									WITH_YAFFS_OOB);
+#endif
 		} else if (!strcmp(s, ".oob")) {
 			/* out-of-band data */
 			mtd_oob_ops_t ops = {
@@ -798,6 +809,11 @@
 	"    'addr', skipping bad blocks and dropping any pages at the end\n"
 	"    of eraseblocks that contain only 0xFF\n"
 #endif
+#ifdef CONFIG_CMD_NAND_YAFFS /*DaQui modified*/
+	"nand write.yaffs - addr off|partition size\n"
+	"	 write 'size' bytes starting at offset 'off' with yaffs format\n"
+	"	 from memory address 'addr', skipping bad blocks.\n"
+#endif
 	"nand erase[.spread] [clean] off size - erase 'size' bytes "
 	"from offset 'off'\n"
 	"    With '.spread', erase enough for given file size, otherwise,\n"
@@ -850,7 +866,7 @@
 
 	s = strchr(cmd, '.');
 	if (s != NULL &&
-	    (strcmp(s, ".jffs2") && strcmp(s, ".e") && strcmp(s, ".i"))) {
+	    (strcmp(s, ".jffs2") && strcmp(s, ".e") && strcmp(s, ".i") && strcmp(s, ".yaffs"))) {
 		printf("Unknown nand load suffix '%s'\n", s);
 		bootstage_error(BOOTSTAGE_ID_NAND_SUFFIX);
 		return 1;
diff -urN u-boot-2016.11/common/board_f.c u-boot-2016.11_100ask/common/board_f.c
--- u-boot-2016.11/common/board_f.c	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/common/board_f.c	2020-07-31 18:02:21.734110593 +0800
@@ -524,6 +524,9 @@
 	gd->relocaddr &= ~(65536 - 1);
 #endif
 
+#ifdef CONFIG_JZ2440 
+	gd->relocaddr = CONFIG_SYS_TEXT_BASE;
+#endif
 	debug("Reserving %ldk for U-Boot at: %08lx\n", gd->mon_len >> 10,
 	      gd->relocaddr);
 
diff -urN u-boot-2016.11/config_ok u-boot-2016.11_100ask/config_ok
--- u-boot-2016.11/config_ok	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/config_ok	2020-07-31 18:02:21.642110163 +0800
@@ -0,0 +1,619 @@
+#
+# Automatically generated file; DO NOT EDIT.
+# U-Boot 2016.11 Configuration
+#
+CONFIG_CREATE_ARCH_SYMLINK=y
+# CONFIG_ARC is not set
+CONFIG_ARM=y
+# CONFIG_AVR32 is not set
+# CONFIG_BLACKFIN is not set
+# CONFIG_M68K is not set
+# CONFIG_MICROBLAZE is not set
+# CONFIG_MIPS is not set
+# CONFIG_NDS32 is not set
+# CONFIG_NIOS2 is not set
+# CONFIG_OPENRISC is not set
+# CONFIG_PPC is not set
+# CONFIG_SANDBOX is not set
+# CONFIG_SH is not set
+# CONFIG_SPARC is not set
+# CONFIG_X86 is not set
+# CONFIG_XTENSA is not set
+CONFIG_SYS_ARCH="arm"
+CONFIG_SYS_CPU="arm920t"
+CONFIG_SYS_SOC="s3c24x0"
+CONFIG_SYS_VENDOR="samsung"
+CONFIG_SYS_BOARD="jz2440"
+CONFIG_SYS_CONFIG_NAME="jz2440"
+
+#
+# ARM architecture
+#
+CONFIG_CPU_ARM920T=y
+CONFIG_SYS_ARM_ARCH=4
+CONFIG_SYS_CACHE_SHIFT_5=y
+CONFIG_SYS_CACHELINE_SIZE=32
+# CONFIG_SEMIHOSTING is not set
+# CONFIG_SYS_L2CACHE_OFF is not set
+# CONFIG_ENABLE_ARM_SOC_BOOT0_HOOK is not set
+# CONFIG_ARCH_AT91 is not set
+# CONFIG_TARGET_EDB93XX is not set
+# CONFIG_TARGET_VCMA9 is not set
+# CONFIG_TARGET_SMDK2410 is not set
+CONFIG_TARGET_JZ2440=y
+# CONFIG_TARGET_ASPENITE is not set
+# CONFIG_TARGET_GPLUGD is not set
+# CONFIG_ARCH_DAVINCI is not set
+# CONFIG_KIRKWOOD is not set
+# CONFIG_ARCH_MVEBU is not set
+# CONFIG_TARGET_DEVKIT3250 is not set
+# CONFIG_TARGET_WORK_92105 is not set
+# CONFIG_TARGET_MX25PDK is not set
+# CONFIG_TARGET_ZMX25 is not set
+# CONFIG_TARGET_APF27 is not set
+# CONFIG_TARGET_APX4DEVKIT is not set
+# CONFIG_TARGET_XFI3 is not set
+# CONFIG_TARGET_M28EVK is not set
+# CONFIG_TARGET_MX23EVK is not set
+# CONFIG_TARGET_MX28EVK is not set
+# CONFIG_TARGET_MX23_OLINUXINO is not set
+# CONFIG_TARGET_BG0900 is not set
+# CONFIG_TARGET_SANSA_FUZE_PLUS is not set
+# CONFIG_TARGET_SC_SPS_1 is not set
+# CONFIG_ORION5X is not set
+# CONFIG_TARGET_SPEAR300 is not set
+# CONFIG_TARGET_SPEAR310 is not set
+# CONFIG_TARGET_SPEAR320 is not set
+# CONFIG_TARGET_SPEAR600 is not set
+# CONFIG_TARGET_STV0991 is not set
+# CONFIG_TARGET_X600 is not set
+# CONFIG_TARGET_IMX31_PHYCORE is not set
+# CONFIG_TARGET_MX31ADS is not set
+# CONFIG_TARGET_MX31PDK is not set
+# CONFIG_TARGET_WOODBURN is not set
+# CONFIG_TARGET_WOODBURN_SD is not set
+# CONFIG_TARGET_FLEA3 is not set
+# CONFIG_TARGET_MX35PDK is not set
+# CONFIG_ARCH_BCM283X is not set
+# CONFIG_TARGET_VEXPRESS_CA15_TC2 is not set
+# CONFIG_TARGET_VEXPRESS_CA5X2 is not set
+# CONFIG_TARGET_VEXPRESS_CA9X4 is not set
+# CONFIG_TARGET_BRXRE1 is not set
+# CONFIG_TARGET_BRPPT1 is not set
+# CONFIG_TARGET_DRACO is not set
+# CONFIG_TARGET_THUBAN is not set
+# CONFIG_TARGET_RASTABAN is not set
+# CONFIG_TARGET_ETAMIN is not set
+# CONFIG_TARGET_PXM2 is not set
+# CONFIG_TARGET_RUT is not set
+# CONFIG_TARGET_TI814X_EVM is not set
+# CONFIG_TARGET_TI816X_EVM is not set
+# CONFIG_TARGET_BCM23550_W1D is not set
+# CONFIG_TARGET_BCM28155_AP is not set
+# CONFIG_TARGET_BCMCYGNUS is not set
+# CONFIG_TARGET_BCMNSP is not set
+# CONFIG_ARCH_EXYNOS is not set
+# CONFIG_ARCH_S5PC1XX is not set
+# CONFIG_ARCH_HIGHBANK is not set
+# CONFIG_ARCH_INTEGRATOR is not set
+# CONFIG_ARCH_KEYSTONE is not set
+# CONFIG_ARCH_MESON is not set
+# CONFIG_ARCH_MX7 is not set
+# CONFIG_ARCH_MX6 is not set
+# CONFIG_ARCH_MX5 is not set
+# CONFIG_TARGET_M53EVK is not set
+# CONFIG_TARGET_MX51EVK is not set
+# CONFIG_TARGET_MX53ARD is not set
+# CONFIG_TARGET_MX53EVK is not set
+# CONFIG_TARGET_MX53LOCO is not set
+# CONFIG_TARGET_MX53SMD is not set
+# CONFIG_OMAP34XX is not set
+# CONFIG_OMAP44XX is not set
+# CONFIG_OMAP54XX is not set
+# CONFIG_AM43XX is not set
+# CONFIG_AM33XX is not set
+# CONFIG_ARCH_RMOBILE is not set
+# CONFIG_TARGET_S32V234EVB is not set
+# CONFIG_ARCH_SNAPDRAGON is not set
+# CONFIG_ARCH_SOCFPGA is not set
+# CONFIG_TARGET_CM_T43 is not set
+# CONFIG_ARCH_SUNXI is not set
+# CONFIG_TARGET_TS4800 is not set
+# CONFIG_TARGET_VF610TWR is not set
+# CONFIG_TARGET_COLIBRI_VF is not set
+# CONFIG_TARGET_PCM052 is not set
+# CONFIG_TARGET_BK4R1 is not set
+# CONFIG_ARCH_ZYNQ is not set
+# CONFIG_ARCH_ZYNQMP is not set
+# CONFIG_TEGRA is not set
+# CONFIG_TARGET_VEXPRESS64_AEMV8A is not set
+# CONFIG_TARGET_VEXPRESS64_BASE_FVP is not set
+# CONFIG_TARGET_VEXPRESS64_BASE_FVP_DRAM is not set
+# CONFIG_TARGET_VEXPRESS64_JUNO is not set
+# CONFIG_TARGET_LS2080A_EMU is not set
+# CONFIG_TARGET_LS2080A_SIMU is not set
+# CONFIG_TARGET_LS2080AQDS is not set
+# CONFIG_TARGET_LS2080ARDB is not set
+# CONFIG_TARGET_HIKEY is not set
+# CONFIG_TARGET_LS1012AQDS is not set
+# CONFIG_TARGET_LS1012ARDB is not set
+# CONFIG_TARGET_LS1012AFRDM is not set
+# CONFIG_TARGET_LS1021AQDS is not set
+# CONFIG_TARGET_LS1021ATWR is not set
+# CONFIG_TARGET_LS1043AQDS is not set
+# CONFIG_TARGET_LS1043ARDB is not set
+# CONFIG_TARGET_LS1046AQDS is not set
+# CONFIG_TARGET_LS1046ARDB is not set
+# CONFIG_TARGET_H2200 is not set
+# CONFIG_TARGET_ZIPITZ2 is not set
+# CONFIG_TARGET_COLIBRI_PXA270 is not set
+# CONFIG_ARCH_UNIPHIER is not set
+# CONFIG_STM32 is not set
+# CONFIG_ARCH_ROCKCHIP is not set
+# CONFIG_TARGET_THUNDERX_88XX is not set
+CONFIG_IDENT_STRING=""
+# CONFIG_PRE_CONSOLE_BUFFER is not set
+# CONFIG_VIDEO is not set
+
+#
+# ARM debug
+#
+# CONFIG_DEBUG_LL is not set
+
+#
+# General setup
+#
+CONFIG_LOCALVERSION=""
+CONFIG_LOCALVERSION_AUTO=y
+CONFIG_CC_OPTIMIZE_FOR_SIZE=y
+# CONFIG_DISTRO_DEFAULTS is not set
+# CONFIG_SYS_MALLOC_F is not set
+CONFIG_EXPERT=y
+CONFIG_SYS_MALLOC_CLEAR_ON_INIT=y
+# CONFIG_TOOLS_DEBUG is not set
+# CONFIG_PHYS_64BIT is not set
+
+#
+# Boot images
+#
+# CONFIG_FIT is not set
+CONFIG_SYS_EXTRA_OPTIONS=""
+# CONFIG_SPL_DFU_SUPPORT is not set
+CONFIG_ARCH_FIXUP_FDT=y
+
+#
+# Boot timing
+#
+# CONFIG_BOOTSTAGE is not set
+CONFIG_BOOTSTAGE_USER_COUNT=20
+CONFIG_BOOTSTAGE_STASH_ADDR=0
+CONFIG_BOOTSTAGE_STASH_SIZE=4096
+
+#
+# Boot media
+#
+# CONFIG_NAND_BOOT is not set
+# CONFIG_ONENAND_BOOT is not set
+# CONFIG_QSPI_BOOT is not set
+# CONFIG_SATA_BOOT is not set
+# CONFIG_SD_BOOT is not set
+# CONFIG_SPI_BOOT is not set
+CONFIG_BOOTDELAY=3
+
+#
+# Console
+#
+# CONFIG_CONSOLE_RECORD is not set
+# CONFIG_SILENT_CONSOLE is not set
+# CONFIG_CONSOLE_MUX is not set
+# CONFIG_SYS_CONSOLE_IS_IN_ENV is not set
+# CONFIG_SYS_CONSOLE_OVERWRITE_ROUTINE is not set
+# CONFIG_SYS_CONSOLE_ENV_OVERWRITE is not set
+# CONFIG_SYS_CONSOLE_INFO_QUIET is not set
+# CONFIG_SYS_STDIO_DEREGISTER is not set
+CONFIG_DEFAULT_FDT_FILE=""
+# CONFIG_SYS_NO_FLASH is not set
+# CONFIG_VERSION_VARIABLE is not set
+CONFIG_DISPLAY_CPUINFO=y
+# CONFIG_DISPLAY_BOARDINFO is not set
+
+#
+# SPL / TPL
+#
+
+#
+# Command line interface
+#
+CONFIG_CMDLINE=y
+CONFIG_HUSH_PARSER=y
+CONFIG_SYS_PROMPT="JZ2440 # "
+
+#
+# Autoboot options
+#
+CONFIG_AUTOBOOT=y
+# CONFIG_AUTOBOOT_KEYED is not set
+
+#
+# FASTBOOT
+#
+# CONFIG_FASTBOOT is not set
+
+#
+# Commands
+#
+
+#
+# Info commands
+#
+CONFIG_CMD_BDI=y
+CONFIG_CMD_CONSOLE=y
+# CONFIG_CMD_CPU is not set
+# CONFIG_CMD_LICENSE is not set
+
+#
+# Boot commands
+#
+CONFIG_CMD_BOOTD=y
+CONFIG_CMD_BOOTM=y
+# CONFIG_CMD_BOOTZ is not set
+# CONFIG_CMD_ELF is not set
+# CONFIG_CMD_GO is not set
+# CONFIG_CMD_RUN is not set
+# CONFIG_CMD_IMI is not set
+# CONFIG_CMD_IMLS is not set
+# CONFIG_CMD_XIMG is not set
+
+#
+# Environment commands
+#
+# CONFIG_CMD_ASKENV is not set
+# CONFIG_CMD_EXPORTENV is not set
+# CONFIG_CMD_IMPORTENV is not set
+CONFIG_CMD_EDITENV=y
+# CONFIG_CMD_GREPENV is not set
+CONFIG_CMD_SAVEENV=y
+CONFIG_CMD_ENV_EXISTS=y
+
+#
+# Memory commands
+#
+CONFIG_CMD_MEMORY=y
+CONFIG_CMD_CRC32=y
+# CONFIG_LOOPW is not set
+# CONFIG_CMD_MEMTEST is not set
+# CONFIG_CMD_MX_CYCLIC is not set
+# CONFIG_CMD_MEMINFO is not set
+
+#
+# Device access commands
+#
+CONFIG_CMD_LOADB=y
+CONFIG_CMD_LOADS=y
+CONFIG_CMD_FLASH=y
+# CONFIG_CMD_ARMFLASH is not set
+# CONFIG_CMD_MMC is not set
+# CONFIG_CMD_NAND is not set
+# CONFIG_CMD_SF is not set
+# CONFIG_CMD_SPI is not set
+# CONFIG_CMD_I2C is not set
+# CONFIG_CMD_USB is not set
+# CONFIG_CMD_DFU is not set
+# CONFIG_CMD_USB_MASS_STORAGE is not set
+# CONFIG_CMD_FPGA is not set
+# CONFIG_CMD_GPIO is not set
+
+#
+# Shell scripting commands
+#
+# CONFIG_CMD_ECHO is not set
+# CONFIG_CMD_ITEST is not set
+# CONFIG_CMD_SOURCE is not set
+# CONFIG_CMD_SETEXPR is not set
+
+#
+# Network commands
+#
+CONFIG_CMD_NET=y
+# CONFIG_CMD_TFTPPUT is not set
+# CONFIG_CMD_TFTPSRV is not set
+# CONFIG_CMD_RARP is not set
+# CONFIG_CMD_DHCP is not set
+CONFIG_CMD_NFS=y
+# CONFIG_CMD_MII is not set
+CONFIG_CMD_PING=y
+# CONFIG_CMD_CDP is not set
+# CONFIG_CMD_SNTP is not set
+# CONFIG_CMD_DNS is not set
+# CONFIG_CMD_LINK_LOCAL is not set
+
+#
+# Misc commands
+#
+# CONFIG_CMD_CACHE is not set
+# CONFIG_CMD_TIME is not set
+# CONFIG_CMD_MISC is not set
+# CONFIG_CMD_TIMER is not set
+# CONFIG_CMD_QFW is not set
+
+#
+# Power commands
+#
+
+#
+# Security commands
+#
+
+#
+# Firmware commands
+#
+
+#
+# Filesystem commands
+#
+# CONFIG_CMD_EXT2 is not set
+# CONFIG_CMD_EXT4 is not set
+# CONFIG_CMD_FAT is not set
+# CONFIG_CMD_FS_GENERIC is not set
+# CONFIG_CMD_UBI is not set
+CONFIG_SUPPORT_OF_CONTROL=y
+
+#
+# Device Tree Control
+#
+# CONFIG_OF_CONTROL is not set
+CONFIG_NET=y
+# CONFIG_NET_RANDOM_ETHADDR is not set
+# CONFIG_NETCONSOLE is not set
+CONFIG_NET_TFTP_VARS=y
+CONFIG_BOOTP_PXE_CLIENTARCH=0x15
+CONFIG_BOOTP_VCI_STRING="U-Boot.arm"
+
+#
+# Device Drivers
+#
+
+#
+# Generic Driver Options
+#
+# CONFIG_DM is not set
+# CONFIG_ADC is not set
+# CONFIG_ADC_EXYNOS is not set
+# CONFIG_ADC_SANDBOX is not set
+# CONFIG_BLOCK_CACHE is not set
+
+#
+# Clock
+#
+# CONFIG_CPU is not set
+
+#
+# Hardware crypto devices
+#
+# CONFIG_FSL_CAAM is not set
+
+#
+# Demo for driver model
+#
+
+#
+# DFU support
+#
+
+#
+# DMA Support
+#
+# CONFIG_TI_EDMA3 is not set
+
+#
+# FPGA support
+#
+# CONFIG_FPGA_XILINX is not set
+
+#
+# GPIO Support
+#
+
+#
+# I2C support
+#
+# CONFIG_SYS_I2C_DW is not set
+# CONFIG_CROS_EC_KEYB is not set
+
+#
+# LED Support
+#
+
+#
+# Mailbox Controller Support
+#
+
+#
+# Memory Controller drivers
+#
+
+#
+# Multifunction device drivers
+#
+# CONFIG_CROS_EC is not set
+# CONFIG_FSL_SEC_MON is not set
+# CONFIG_MXC_OCOTP is not set
+# CONFIG_NUVOTON_NCT6102D is not set
+# CONFIG_PCA9551_LED is not set
+# CONFIG_WINBOND_W83627 is not set
+
+#
+# MMC Host controller Support
+#
+
+#
+# MTD Support
+#
+
+#
+# NAND Device Support
+#
+# CONFIG_NAND_DENALI is not set
+# CONFIG_NAND_VF610_NFC is not set
+# CONFIG_NAND_PXA3XX is not set
+# CONFIG_NAND_ARASAN is not set
+
+#
+# Generic NAND options
+#
+
+#
+# SPI Flash Support
+#
+# CONFIG_SPI_FLASH is not set
+
+#
+# UBI support
+#
+# CONFIG_MTD_UBI is not set
+# CONFIG_PHYLIB is not set
+# CONFIG_NETDEVICES is not set
+# CONFIG_PCI is not set
+# CONFIG_MVEBU_COMPHY_SUPPORT is not set
+
+#
+# Pin controllers
+#
+
+#
+# Power
+#
+
+#
+# Power Domain Support
+#
+
+#
+# Remote Processor drivers
+#
+
+#
+# Reset Controller Support
+#
+
+#
+# Real Time Clock
+#
+
+#
+# Serial drivers
+#
+# CONFIG_DEBUG_UART is not set
+# CONFIG_DEBUG_UART_SKIP_INIT is not set
+# CONFIG_ATMEL_USART is not set
+# CONFIG_FSL_LPUART is not set
+# CONFIG_MVEBU_A3700_UART is not set
+# CONFIG_SYS_NS16550 is not set
+
+#
+# Sound support
+#
+# CONFIG_SOUND is not set
+
+#
+# SPI Support
+#
+# CONFIG_FSL_ESPI is not set
+# CONFIG_FSL_QSPI is not set
+# CONFIG_TI_QSPI is not set
+
+#
+# SPMI support
+#
+
+#
+# System reset device drivers
+#
+# CONFIG_DM_THERMAL is not set
+
+#
+# Timer Support
+#
+
+#
+# TPM support
+#
+CONFIG_USB=y
+
+#
+# USB Host Controller Drivers
+#
+# CONFIG_USB_XHCI_HCD is not set
+# CONFIG_USB_EHCI_HCD is not set
+# CONFIG_USB_EHCI is not set
+# CONFIG_USB_OHCI_HCD is not set
+# CONFIG_USB_UHCI_HCD is not set
+
+#
+# MUSB Controller Driver
+#
+# CONFIG_USB_MUSB_HOST is not set
+# CONFIG_USB_MUSB_GADGET is not set
+
+#
+# ULPI drivers
+#
+
+#
+# USB peripherals
+#
+# CONFIG_USB_STORAGE is not set
+# CONFIG_USB_KEYBOARD is not set
+# CONFIG_USB_GADGET is not set
+
+#
+# Graphics support
+#
+
+#
+# TrueType Fonts
+#
+# CONFIG_VIDEO_VESA is not set
+# CONFIG_VIDEO_LCD_ANX9804 is not set
+# CONFIG_VIDEO_LCD_SSD2828 is not set
+# CONFIG_VIDEO_MVEBU is not set
+# CONFIG_LCD is not set
+# CONFIG_PHYS_TO_BUS is not set
+
+#
+# File systems
+#
+
+#
+# Library routines
+#
+# CONFIG_CC_OPTIMIZE_LIBS_FOR_SPEED is not set
+CONFIG_HAVE_PRIVATE_LIBGCC=y
+CONFIG_USE_PRIVATE_LIBGCC=y
+CONFIG_SYS_HZ=1000
+# CONFIG_USE_TINY_PRINTF is not set
+CONFIG_REGEX=y
+# CONFIG_LIB_RAND is not set
+# CONFIG_CMD_DHRYSTONE is not set
+# CONFIG_RSA is not set
+
+#
+# Hashing Support
+#
+# CONFIG_SHA1 is not set
+# CONFIG_SHA256 is not set
+# CONFIG_SHA_HW_ACCEL is not set
+
+#
+# Compression Support
+#
+# CONFIG_LZ4 is not set
+# CONFIG_ERRNO_STR is not set
+# CONFIG_OF_LIBFDT is not set
+# CONFIG_OF_LIBFDT_OVERLAY is not set
+# CONFIG_SPL_OF_LIBFDT is not set
+
+#
+# System tables
+#
+# CONFIG_UNIT_TEST is not set
diff -urN u-boot-2016.11/configs/jz2440_defconfig u-boot-2016.11_100ask/configs/jz2440_defconfig
--- u-boot-2016.11/configs/jz2440_defconfig	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/configs/jz2440_defconfig	2020-07-31 18:02:21.734110593 +0800
@@ -0,0 +1,18 @@
+CONFIG_ARM=y
+CONFIG_TARGET_JZ2440=y
+CONFIG_BOOTDELAY=3
+# CONFIG_SYS_STDIO_DEREGISTER is not set
+# CONFIG_DISPLAY_BOARDINFO is not set
+CONFIG_HUSH_PARSER=y
+CONFIG_SYS_PROMPT="JZ2440 # "
+CONFIG_CMD_USB=y
+# CONFIG_CMD_SETEXPR is not set
+# CONFIG_CMD_DHCP=y
+CONFIG_CMD_PING=y
+# CONFIG_CMD_CACHE=y
+# CONFIG_CMD_EXT2=y
+# CONFIG_CMD_FAT=y
+# CONFIG_CMD_UBI=y
+CONFIG_USB=y
+# CONFIG_USB_STORAGE=y
+# CONFIG_USB_KEYBOARD=y
diff -urN u-boot-2016.11/drivers/mtd/jedec_flash.c u-boot-2016.11_100ask/drivers/mtd/jedec_flash.c
--- u-boot-2016.11/drivers/mtd/jedec_flash.c	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/drivers/mtd/jedec_flash.c	2020-07-31 18:02:21.762110724 +0800
@@ -401,6 +401,26 @@
 		}
 	},
 #endif
+	/* DaQui modified MXMT29LV160DB */
+#ifdef CONFIG_SYS_FLASH_LEGACY_2Mx8
+	{
+		.mfr_id         = (u16)MX_MANUFACT,  
+		.dev_id         = 0X2249,           
+		.name           = "MXIC MT29LV160DB",
+		.uaddr          = { 
+	       	 [1] = MTD_UADDR_0x0555_0x02AA 
+		},
+		.DevSize        = SIZE_2MiB,   
+		.CmdSet         = P_ID_AMD_STD,
+		.NumEraseRegions= 4,
+		.regions        = {
+		        ERASEINFO(16*1024, 1),
+		        ERASEINFO(8*1024, 2),
+		        ERASEINFO(32*1024, 1),
+		        ERASEINFO(64*1024, 31),
+		}
+	},
+#endif
 };
 
 static inline void fill_info(flash_info_t *info, const struct amd_flash_info *jedec_entry, ulong base)
diff -urN u-boot-2016.11/drivers/mtd/nand/Makefile u-boot-2016.11_100ask/drivers/mtd/nand/Makefile
--- u-boot-2016.11/drivers/mtd/nand/Makefile	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/drivers/mtd/nand/Makefile	2020-07-31 18:02:21.762110724 +0800
@@ -61,6 +61,7 @@
 obj-$(CONFIG_NAND_NDFC) += ndfc.o
 obj-$(CONFIG_NAND_PXA3XX) += pxa3xx_nand.o
 obj-$(CONFIG_NAND_S3C2410) += s3c2410_nand.o
+obj-$(CONFIG_NAND_S3C2440) += s3c2440_nand.o
 obj-$(CONFIG_NAND_SPEAR) += spr_nand.o
 obj-$(CONFIG_TEGRA_NAND) += tegra_nand.o
 obj-$(CONFIG_NAND_OMAP_GPMC) += omap_gpmc.o
diff -urN u-boot-2016.11/drivers/mtd/nand/nand_util.c u-boot-2016.11_100ask/drivers/mtd/nand/nand_util.c
--- u-boot-2016.11/drivers/mtd/nand/nand_util.c	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/drivers/mtd/nand/nand_util.c	2020-07-31 18:02:21.762110724 +0800
@@ -580,8 +580,27 @@
 
 	if (actual)
 		*actual = 0;
-
-	blocksize = mtd->erasesize;
+	
+	/*DaQui Modified*/
+#ifdef CONFIG_CMD_NAND_YAFFS /*DaQui modified*/
+	if (flags & WITH_YAFFS_OOB) {
+		if (flags & ~WITH_YAFFS_OOB)
+			return -EINVAL;
+
+		int pages;
+		pages = mtd->erasesize / mtd->writesize;
+			blocksize = (pages * mtd->oobsize) + mtd->erasesize;
+		if (*length % (mtd->writesize + mtd->oobsize)) {
+				printf ("Attempt to write incomplete page"
+							" in yaffs mode\n");
+				return -EINVAL;
+		}
+	} 
+	else
+#endif
+	{
+		blocksize = mtd->erasesize;
+	}
 
 	/*
 	 * nand_write() handles unaligned, partial page writes.
@@ -616,8 +635,8 @@
 		*length = 0;
 		return -EFBIG;
 	}
-
-	if (!need_skip && !(flags & WITH_DROP_FFS)) {
+	
+	if (!need_skip && !(flags & WITH_DROP_FFS) && !(flags & WITH_YAFFS_OOB)) {
 		rval = nand_write(mtd, offset, length, buffer);
 
 		if ((flags & WITH_WR_VERIFY) && !rval)
@@ -631,7 +650,7 @@
 			offset, rval);
 		return rval;
 	}
-
+	
 	while (left_to_write > 0) {
 		size_t block_offset = offset & (mtd->erasesize - 1);
 		size_t write_size, truncated_write_size;
@@ -650,22 +669,51 @@
 		else
 			write_size = blocksize - block_offset;
 
-		truncated_write_size = write_size;
+#ifdef CONFIG_CMD_NAND_YAFFS /*DaQui modified*/
+		if (flags & WITH_YAFFS_OOB) {
+			int page, pages;
+			size_t pagesize = mtd->writesize;
+			size_t pagesize_oob = pagesize + mtd->oobsize;
+			struct mtd_oob_ops ops;
+
+			ops.len = pagesize;
+			ops.ooblen = mtd->oobsize;
+			ops.mode = MTD_OPS_RAW;
+			ops.ooboffs = 0;
+
+			pages = write_size / pagesize_oob;
+			for (page = 0; page < pages; page++) {
+				WATCHDOG_RESET();
+
+				ops.datbuf = p_buffer;
+				ops.oobbuf = ops.datbuf + pagesize;
+
+				rval = mtd->_write_oob(mtd, offset, &ops);
+				if (rval)  /* weidongshan@qq.com */
+						break;
+
+				offset += pagesize;
+				p_buffer += pagesize_oob;
+			}
+		}
+		else
+#endif
+		{
+			truncated_write_size = write_size;
 #ifdef CONFIG_CMD_NAND_TRIMFFS
-		if (flags & WITH_DROP_FFS)
-			truncated_write_size = drop_ffs(mtd, p_buffer,
-					&write_size);
+			if (flags & WITH_DROP_FFS)
+				truncated_write_size = drop_ffs(mtd, p_buffer,
+						&write_size);
 #endif
+			rval = nand_write(mtd, offset, &truncated_write_size,
+					p_buffer);
+			if ((flags & WITH_WR_VERIFY) && !rval)
+				rval = nand_verify(mtd, offset,
+					truncated_write_size, p_buffer);
 
-		rval = nand_write(mtd, offset, &truncated_write_size,
-				p_buffer);
-
-		if ((flags & WITH_WR_VERIFY) && !rval)
-			rval = nand_verify(mtd, offset,
-				truncated_write_size, p_buffer);
-
-		offset += write_size;
-		p_buffer += write_size;
+			offset += write_size;
+			p_buffer += write_size;
+		}
 
 		if (rval != 0) {
 			printf("NAND write to offset %llx failed %d\n",
diff -urN u-boot-2016.11/drivers/mtd/nand/s3c2440_nand.c u-boot-2016.11_100ask/drivers/mtd/nand/s3c2440_nand.c
--- u-boot-2016.11/drivers/mtd/nand/s3c2440_nand.c	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/drivers/mtd/nand/s3c2440_nand.c	2020-07-31 18:02:21.762110724 +0800
@@ -0,0 +1,186 @@
+/*
+ * (C) Copyright 2006 OpenMoko, Inc.
+ * Author: Harald Welte <laforge@openmoko.org>
+ *
+ * SPDX-License-Identifier:	GPL-2.0+
+ */
+ 
+/* DaQui Modified */
+#include <common.h>
+
+#include <nand.h>
+#include <asm/arch/s3c24x0_cpu.h>
+#include <asm/io.h>
+
+#define S3C2440_NFCONF_EN          (1<<15)
+#define S3C2440_NFCONF_512BYTE     (1<<14)
+#define S3C2440_NFCONF_4STEP       (1<<13)
+#define S3C2440_NFCONF_INITECC     (1<<12)
+#define S3C2440_NFCONF_nFCE        (1<<11)
+#define S3C2440_NFCONF_TACLS(x)    ((x)<<8)
+#define S3C2440_NFCONF_TWRPH0(x)   ((x)<<4)
+#define S3C2440_NFCONF_TWRPH1(x)   ((x)<<0)
+
+#define S3C2440_ADDR_NALE 4
+#define S3C2440_ADDR_NCLE 8
+
+#ifdef CONFIG_NAND_SPL
+
+/* in the early stage of NAND flash booting, printf() is not available */
+#define printf(fmt, args...)
+
+static void nand_read_buf(struct mtd_info *mtd, u_char *buf, int len)
+{
+	int i;
+	struct nand_chip *this = mtd_to_nand(mtd);
+
+	for (i = 0; i < len; i++)
+		buf[i] = readb(this->IO_ADDR_R);
+}
+#endif
+
+static void s3c24x0_hwcontrol(struct mtd_info *mtd, int cmd, unsigned int ctrl)
+{
+	   struct s3c24x0_nand *nand = s3c24x0_get_base_nand();
+
+		if (ctrl & NAND_CLE)
+		{
+			//write command
+			writeb(cmd, &nand->nfcmd);
+		}
+		else if(ctrl & NAND_ALE)
+		{
+			//write address
+			writeb(cmd, &nand->nfaddr);
+		}
+}
+
+static int s3c24x0_dev_ready(struct mtd_info *mtd)
+{
+	struct s3c24x0_nand *nand = s3c24x0_get_base_nand();
+	debug("dev_ready\n");
+	return readl(&nand->nfstat) & 0x01;
+}
+
+#ifdef CONFIG_S3C2440_NAND_HWECC
+void s3c24x0_nand_enable_hwecc(struct mtd_info *mtd, int mode)
+{
+	struct s3c24x0_nand *nand = s3c24x0_get_base_nand();
+	debug("s3c24x0_nand_enable_hwecc(%p, %d)\n", mtd, mode);
+	writel(readl(&nand->nfconf) | S3C2440_NFCONF_INITECC, &nand->nfconf);
+}
+
+static int s3c24x0_nand_calculate_ecc(struct mtd_info *mtd, const u_char *dat,
+				      u_char *ecc_code)
+{
+	struct s3c24x0_nand *nand = s3c24x0_get_base_nand();
+	ecc_code[0] = readb(&nand->nfecc);
+	ecc_code[1] = readb(&nand->nfecc + 1);
+	ecc_code[2] = readb(&nand->nfecc + 2);
+	debug("s3c24x0_nand_calculate_hwecc(%p,): 0x%02x 0x%02x 0x%02x\n",
+	      mtd , ecc_code[0], ecc_code[1], ecc_code[2]);
+
+	return 0;
+}
+
+static int s3c24x0_nand_correct_data(struct mtd_info *mtd, u_char *dat,
+				     u_char *read_ecc, u_char *calc_ecc)
+{
+	if (read_ecc[0] == calc_ecc[0] &&
+	    read_ecc[1] == calc_ecc[1] &&
+	    read_ecc[2] == calc_ecc[2])
+		return 0;
+
+	printf("s3c24x0_nand_correct_data: not implemented\n");
+	return -EBADMSG;
+}
+#endif
+
+static void s3c2440_nand_select(struct mtd_info *mtd, int chipnr)
+{
+        struct s3c24x0_nand *nand = s3c24x0_get_base_nand();
+
+        switch (chipnr) {
+        case -1: 
+                nand->nfcont |= (1<<1);
+                break;
+        case 0:
+                nand->nfcont &= ~(1<<1);
+                break;
+        default:
+                BUG();
+        }
+}
+
+int board_nand_init(struct nand_chip *nand)
+{
+	u_int32_t cfg;
+	u_int8_t tacls, twrph0, twrph1;
+	struct s3c24x0_clock_power *clk_power = s3c24x0_get_base_clock_power();
+	struct s3c24x0_nand *nand_reg = s3c24x0_get_base_nand();
+
+	debug("board_nand_init()\n");
+
+	writel(readl(&clk_power->clkcon) | (1 << 4), &clk_power->clkcon);
+
+	/* initialize hardware */
+#if defined(CONFIG_S3C24XX_CUSTOM_NAND_TIMING)
+	tacls  = CONFIG_S3C24XX_TACLS;
+	twrph0 = CONFIG_S3C24XX_TWRPH0;
+	twrph1 =  CONFIG_S3C24XX_TWRPH1;
+#else
+	tacls = 4;
+	twrph0 = 8;
+	twrph1 = 8;
+#endif
+
+#if 0
+	cfg = S3C2440_NFCONF_EN;
+	cfg |= S3C2440_NFCONF_TACLS(tacls - 1);
+	cfg |= S3C2440_NFCONF_TWRPH0(twrph0 - 1);
+	cfg |= S3C2440_NFCONF_TWRPH1(twrph1 - 1);
+	writel(cfg, &nand_reg->nfconf);
+#endif
+	
+	cfg = ((tacls-1)<<12)|((twrph0-1)<<8)|((twrph1-1)<<4);
+			writel(cfg, &nand_reg->nfconf);
+			
+	writel((1<<4)|(1<<1)|(1<<0), &nand_reg->nfcont);
+			
+	/* initialize nand_chip data structure */
+	nand->IO_ADDR_R = (void *)&nand_reg->nfdata;
+	nand->IO_ADDR_W = (void *)&nand_reg->nfdata;
+
+	nand->select_chip = s3c2440_nand_select;
+
+	/* read_buf and write_buf are default */
+	/* read_byte and write_byte are default */
+#ifdef CONFIG_NAND_SPL
+	nand->read_buf = nand_read_buf;
+#endif
+
+	/* hwcontrol always must be implemented */
+	nand->cmd_ctrl = s3c24x0_hwcontrol;
+
+	nand->dev_ready = s3c24x0_dev_ready;
+
+#ifdef CONFIG_S3C2440_NAND_HWECC
+	nand->ecc.hwctl = s3c24x0_nand_enable_hwecc;
+	nand->ecc.calculate = s3c24x0_nand_calculate_ecc;
+	nand->ecc.correct = s3c24x0_nand_correct_data;
+	nand->ecc.mode = NAND_ECC_HW;
+	nand->ecc.size = CONFIG_SYS_NAND_ECCSIZE;
+	nand->ecc.bytes = CONFIG_SYS_NAND_ECCBYTES;
+	nand->ecc.strength = 1;
+#else
+	nand->ecc.mode = NAND_ECC_SOFT;
+#endif
+
+#ifdef CONFIG_S3C2440_NAND_BBT
+	nand->bbt_options |= NAND_BBT_USE_FLASH;
+#endif
+
+	debug("end of nand_init\n");
+
+	return 0;
+}
diff -urN u-boot-2016.11/include/configs/jz2440.h u-boot-2016.11_100ask/include/configs/jz2440.h
--- u-boot-2016.11/include/configs/jz2440.h	1970-01-01 08:00:00.000000000 +0800
+++ u-boot-2016.11_100ask/include/configs/jz2440.h	2020-07-31 18:02:21.782110817 +0800
@@ -0,0 +1,215 @@
+/*
+ * (C) Copyright 2002
+ * Sysgo Real-Time Solutions, GmbH <www.elinos.com>
+ * Marius Groeger <mgroeger@sysgo.de>
+ * Gary Jennejohn <garyj@denx.de>
+ * David Mueller <d.mueller@elsoft.ch>
+ *
+ * Configuation settings for the SAMSUNG SMDK2410 board.
+ *
+ * SPDX-License-Identifier:	GPL-2.0+
+ */
+
+#ifndef __CONFIG_H
+#define __CONFIG_H
+
+/*DaQui modified*/
+#define CONFIG_SPL
+#define CONFIG_SPL_STACK	(0x30000000 + 0x1000 - 176)
+#define CONFIG_SPL_TEXT_BASE 0x0
+
+/*
+ * High Level Configuration Options
+ * (easy to change)
+ */
+#define CONFIG_S3C24X0		/* This is a SAMSUNG S3C24x0-type SoC */
+#define CONFIG_S3C2440		/* specifically a SAMSUNG S3C2440 SoC */
+/*#define CONFIG_SMDK2440		 on a SAMSUNG SMDK2440 Board */
+#define CONFIG_JZ2440		/* on a 100ask JZ2440 Board */
+
+#define CONFIG_SYS_TEXT_BASE	0x33F00000
+
+#define CONFIG_SYS_ARM_CACHE_WRITETHROUGH
+
+/* input clock of PLL (the SMDK2410 has 12MHz input clock) */
+#define CONFIG_SYS_CLK_FREQ	12000000
+
+#define CONFIG_CMDLINE_TAG	/* enable passing of ATAGs */
+#define CONFIG_SETUP_MEMORY_TAGS
+#define CONFIG_INITRD_TAG
+
+/*
+ * Hardware drivers  
+ */
+/*DaQui modified*/
+#define CONFIG_DRIVER_DM9000
+#define CONFIG_DM9000_BASE              0x20000000
+#define DM9000_IO                       CONFIG_DM9000_BASE
+#define DM9000_DATA                     (CONFIG_DM9000_BASE + 4)
+
+/*
+ * select serial console configuration
+ */
+#define CONFIG_S3C24X0_SERIAL
+#define CONFIG_SERIAL1		1	/* we use SERIAL 1 on SMDK2440 */
+
+/************************************************************
+ * USB support (currently only works with D-cache off)
+ ************************************************************/
+
+#define CONFIG_USB_OHCI
+#define CONFIG_USB_OHCI_S3C24XX
+#if 0 /*DaQui modified*/
+#define CONFIG_DOS_PARTITION
+#endif
+
+/************************************************************
+ * RTC
+ ************************************************************/
+#define CONFIG_RTC_S3C24X0
+
+#define CONFIG_BAUDRATE		115200
+
+/*
+ * BOOTP options
+ */
+
+#if 0  /*DaQui modified*/
+#define CONFIG_BOOTP_BOOTFILESIZE
+#define CONFIG_BOOTP_BOOTPATH
+#define CONFIG_BOOTP_GATEWAY
+#define CONFIG_BOOTP_HOSTNAME
+#endif
+
+/*DaQui modified*/
+#define CONFIG_CMD_NAND_YAFFS
+#define CONFIG_BOOTARGS "console=ttySAC0 root=/dev/mtdblock4"
+#define CONFIG_BOOTCOMMAND "nand read 30000000 kernel;bootm 30000000"
+
+/*
+ * Command line configuration.
+ */
+#define CONFIG_CMD_BSP
+#define CONFIG_CMD_DATE
+#define CONFIG_CMD_NAND
+#define CONFIG_CMD_REGINFO
+
+#define CONFIG_CMDLINE_EDITING
+
+/* autoboot */
+#define CONFIG_BOOT_RETRY_TIME	-1
+#define CONFIG_RESET_TO_RETRY
+
+#define CONFIG_NETMASK		255.255.255.0
+#define CONFIG_IPADDR		192.168.1.17
+#define CONFIG_SERVERIP		192.168.1.11
+#define CONFIG_ETHADDR		60:F2:EF:03:03:1A
+
+#if defined(CONFIG_CMD_KGDB)
+#define CONFIG_KGDB_BAUDRATE	115200	/* speed to run kgdb serial port */
+#endif
+
+/*
+ * Miscellaneous configurable options
+ */
+#define CONFIG_SYS_LONGHELP		/* undef to save memory */
+#define CONFIG_SYS_CBSIZE	256
+/* Print Buffer Size */
+#define CONFIG_SYS_PBSIZE	(CONFIG_SYS_CBSIZE + \
+				sizeof(CONFIG_SYS_PROMPT)+16)
+#define CONFIG_SYS_MAXARGS	16
+#define CONFIG_SYS_BARGSIZE	CONFIG_SYS_CBSIZE
+
+#define CONFIG_SYS_MEMTEST_START	0x30000000	/* memtest works on */
+#define CONFIG_SYS_MEMTEST_END		0x33F00000	/* 63 MB in DRAM */
+
+#define CONFIG_SYS_LOAD_ADDR		0x30800000
+
+/* support additional compression methods */
+#if 0  /*DaQui modified*/
+#define CONFIG_BZIP2
+#define CONFIG_LZO
+#define CONFIG_LZMA
+#endif
+
+/*-----------------------------------------------------------------------
+ * Physical Memory Map
+ */
+#define CONFIG_NR_DRAM_BANKS	1          /* we have 1 bank of DRAM */
+#define PHYS_SDRAM_1		0x30000000 /* SDRAM Bank #1 */
+#define PHYS_SDRAM_1_SIZE	0x04000000 /* 64 MB */
+
+#define PHYS_FLASH_1		0x00000000 /* Flash Bank #0 */
+
+#define CONFIG_SYS_FLASH_BASE	PHYS_FLASH_1
+
+/*-----------------------------------------------------------------------
+ * FLASH and environment organization
+ */
+
+#define CONFIG_SYS_FLASH_CFI
+#define CONFIG_FLASH_CFI_DRIVER
+#define CONFIG_FLASH_CFI_LEGACY
+#define CONFIG_SYS_FLASH_LEGACY_2Mx8
+#define CONFIG_FLASH_SHOW_PROGRESS	45
+
+/*DaQui modified*/
+#define CONFIG_SYS_MAX_FLASH_BANKS	1
+#define CONFIG_SYS_FLASH_BANKS_LIST     { CONFIG_SYS_FLASH_BASE }
+#define CONFIG_SYS_MAX_FLASH_SECT	(64)
+
+/*DaQui modified*/
+#define CONFIG_ENV_IS_IN_NAND
+#define CONFIG_ENV_OFFSET		0x60000
+#define CONFIG_ENV_SIZE			0x20000
+#define CONFIG_ENV_RANGE       CONFIG_ENV_SIZE
+/* allow to overwrite serial and ethaddr */
+#define CONFIG_ENV_OVERWRITE
+
+/*
+ * Size of malloc() pool
+ * BZIP2 / LZO / LZMA need a lot of RAM
+ */
+#define CONFIG_SYS_MALLOC_LEN	(4 * 1024 * 1024)
+
+#define CONFIG_SYS_MONITOR_LEN	(448 * 1024)
+#define CONFIG_SYS_MONITOR_BASE	CONFIG_SYS_FLASH_BASE
+
+/*
+ * NAND configuration  
+ */
+ /*DaQui modified*/
+#ifdef CONFIG_CMD_NAND
+#define CONFIG_NAND_S3C2440
+/* #define CONFIG_SYS_S3C2410_NAND_HWECC */ /* DaQui modified */
+#define CONFIG_SYS_MAX_NAND_DEVICE	1
+#define CONFIG_SYS_NAND_BASE		0x4E000000
+#endif
+
+/*
+ * File system  
+ */
+ /*DaQui modified*/
+ #define CONFIG_RBTREE
+#define CONFIG_CMD_MTDPARTS
+#define CONFIG_MTD_DEVICE
+/* #define CONFIG_MTD_PARTITIONS */
+#define MTDIDS_DEFAULT          "nand0=jz2440-0"  
+#define MTDPARTS_DEFAULT        "mtdparts=jz2440-0:128k@0(spl),"        \
+                                                "256k(bootloader),"     \
+                                                "128k(params),"         \
+                                                "2m(kernel),"   \
+                                                "-(root)"       
+#if 0  /*DaQui modified*/
+#define CONFIG_CMD_UBIFS
+#define CONFIG_YAFFS2
+#endif
+
+/* additions for new relocation code, must be added to all boards */
+#define CONFIG_SYS_SDRAM_BASE	PHYS_SDRAM_1
+#define CONFIG_SYS_INIT_SP_ADDR	(CONFIG_SYS_SDRAM_BASE + 0x1000 - \
+				GENERATED_GBL_DATA_SIZE)
+
+#define CONFIG_BOARD_EARLY_INIT_F
+
+#endif /* __CONFIG_H */
diff -urN u-boot-2016.11/include/nand.h u-boot-2016.11_100ask/include/nand.h
--- u-boot-2016.11/include/nand.h	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/include/nand.h	2020-07-31 18:02:21.794110873 +0800
@@ -103,6 +103,9 @@
 
 #define WITH_DROP_FFS	(1 << 0) /* drop trailing all-0xff pages */
 #define WITH_WR_VERIFY	(1 << 1) /* verify data was written correctly */
+#define WITH_YAFFS_OOB  (1 << 2) /* whether write with yaffs format. This flag
+								  * is a 'mode' meaning it cannot be mixed with
+								  * other flags */
 
 int nand_write_skip_bad(struct mtd_info *mtd, loff_t offset, size_t *length,
 			size_t *actual, loff_t lim, u_char *buffer, int flags);
diff -urN u-boot-2016.11/Makefile u-boot-2016.11_100ask/Makefile
--- u-boot-2016.11/Makefile	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/Makefile	2020-07-31 18:02:21.642110163 +0800
@@ -7,6 +7,8 @@
 SUBLEVEL =
 EXTRAVERSION =
 NAME =
+ARCH = arm
+CROSS_COMPILE = arm-linux-
 
 # *DOCUMENTATION*
 # To see a list of typical targets execute "make help"
@@ -243,7 +245,7 @@
 
 # set default to nothing for native builds
 ifeq ($(HOSTARCH),$(ARCH))
-CROSS_COMPILE ?=
+CROSS_COMPILE ?= 
 endif
 
 KCONFIG_CONFIG	?= .config
diff -urN u-boot-2016.11/scripts/config_whitelist.txt u-boot-2016.11_100ask/scripts/config_whitelist.txt
--- u-boot-2016.11/scripts/config_whitelist.txt	2016-11-15 00:27:11.000000000 +0800
+++ u-boot-2016.11_100ask/scripts/config_whitelist.txt	2020-07-31 18:02:21.802110910 +0800
@@ -611,6 +611,7 @@
 CONFIG_CMD_NAND_LOCK_UNLOCK
 CONFIG_CMD_NAND_TORTURE
 CONFIG_CMD_NAND_TRIMFFS
+CONFIG_CMD_NAND_YAFFS
 CONFIG_CMD_ONENAND
 CONFIG_CMD_OTP
 CONFIG_CMD_PART
@@ -1729,6 +1730,7 @@
 CONFIG_JTAG_CONSOLE
 CONFIG_JTAG_CONSOLE_TIMEOUT
 CONFIG_JUPITER
+CONFIG_JZ2440
 CONFIG_K2E_EVM
 CONFIG_K2G_EVM
 CONFIG_K2HK_EVM
@@ -3312,6 +3314,7 @@
 CONFIG_NAND_OMAP_GPMC_WSCFG
 CONFIG_NAND_PLAT
 CONFIG_NAND_S3C2410
+CONFIG_NAND_S3C2440
 CONFIG_NAND_SECBOOT
 CONFIG_NAND_SPL
 CONFIG_NAND_U_BOOT
@@ -5187,6 +5190,7 @@
 CONFIG_SYS_FLASH_CHECK_BLANK_BEFORE_ERASE
 CONFIG_SYS_FLASH_EMPTY_INFO
 CONFIG_SYS_FLASH_ERASE_TOUT
+CONFIG_SYS_FLASH_LEGACY_2Mx8
 CONFIG_SYS_FLASH_LEGACY_256Kx8
 CONFIG_SYS_FLASH_LEGACY_512Kx16
 CONFIG_SYS_FLASH_LEGACY_512Kx8
